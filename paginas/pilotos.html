<script defer>
  let jogo = {};
  async function carregar() {
    jogo = loadGameData();
    if (!jogo) {
      alert("Jogo nÃ£o carregado.");
      location.href = "../index.html";
      return;
    }

    const pilotos = await fetch("../data/pilotos.json").then(r => r.json());
    const lista = document.getElementById("lista");

    pilotos.forEach(p => {
      const contratado = jogo.pilotos.includes(p.nome);
      let botao;

      if (contratado) {
        botao = `<button onclick="demitir('${p.nome}')">Demitir</button>`;
      } else {
        botao = `<button onclick="contratar('${p.nome}')">Contratar</button>`;
      }

      const item = document.createElement("div");
      item.innerHTML = `<strong>${p.nome}</strong> (${p.pais}) - Talento: ${p.talento} ${botao}`;
      lista.appendChild(item);
    });
  }

  function contratar(nome) {
    if (jogo.pilotos.includes(nome)) {
      alert("Piloto jÃ¡ estÃ¡ contratado.");
      return;
    }
    if (jogo.pilotos.length >= 2) {
      alert("VocÃª sÃ³ pode ter 2 pilotos.");
      return;
    }
    jogo.pilotos.push(nome);

    jogo.ultimasNoticias = jogo.ultimasNoticias || [];
    jogo.ultimasNoticias.push(`âœ… Piloto ${nome} foi contratado pela equipe ${jogo.equipe}.`);
    if (jogo.ultimasNoticias.length > 20) {
      jogo.ultimasNoticias = jogo.ultimasNoticias.slice(-20);
    }

    saveGame(jogo);
    alert(`${nome} contratado.`);
    location.reload();
  }

  function demitir(nome) {
    const confirmacao = confirm(`Tem certeza que deseja demitir ${nome}?`);
    if (!confirmacao) return;

    const indice = jogo.pilotos.indexOf(nome);
    if (indice !== -1) {
      jogo.pilotos.splice(indice, 1);

      jogo.ultimasNoticias = jogo.ultimasNoticias || [];
      jogo.ultimasNoticias.push(`ðŸ”¥ Piloto ${nome} foi demitido da equipe ${jogo.equipe}.`);
      if (jogo.ultimasNoticias.length > 20) {
        jogo.ultimasNoticias = jogo.ultimasNoticias.slice(-20);
      }

      saveGame(jogo);
      alert(`${nome} demitido.`);
      location.reload();
    }
  }

  window.onload = carregar;
</script>

  <button onclick="window.location.href='../menu-principal.html'">Voltar</button>
</body>
</html>
